<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="fitTPT fits Transition Path Theory on the transition model defined using fitTransitionModel(), at
a 'coarse-grained' level where transitions are considered between *groups* of cells with grouping indicated by the user."><title>Fit Transition Path Theory (TPT) on the cellrank transition models — fitTPT • sciCSR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Transition Path Theory (TPT) on the cellrank transition models — fitTPT"><meta property="og:description" content="fitTPT fits Transition Path Theory on the transition model defined using fitTransitionModel(), at
a 'coarse-grained' level where transitions are considered between *groups* of cells with grouping indicated by the user."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sciCSR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Basic sciCSR usage</h6>
    <a class="dropdown-item" href="../articles/csr.html">Analysing Class-Switch Recombination in B cell scRNA-seq data using sciCSR</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Comparing CSR/SHM/RNA velocity</h6>
    <a class="dropdown-item" href="../articles/comparison.html">Comparing state transitions inferred using CSR, SHM and RNA velocity</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://josephng-bio.org">Joseph Ng's website</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Fraternalilab/sciCSR/" aria-label="github">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://twitter.com/JosefNg1" aria-label="Twitter">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit Transition Path Theory (TPT) on the cellrank transition models</h1>
      
      <div class="d-none name"><code>fitTPT.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>fitTPT</code> fits Transition Path Theory on the transition model defined using <code><a href="fitTransitionModel.html">fitTransitionModel</a>()</code>, at
a 'coarse-grained' level where transitions are considered between *groups* of cells with grouping indicated by the user.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fitTPT</span><span class="op">(</span></span>
<span>  <span class="va">anndata_file</span>,</span>
<span>  <span class="va">CellrankObj</span>,</span>
<span>  <span class="va">group.cells.by</span>,</span>
<span>  <span class="va">source_state</span>,</span>
<span>  <span class="va">target_state</span>,</span>
<span>  conda_env <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  random_n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  do_pca <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  do_neighbors <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>anndata_file</dt>
<dd><p>filename pointing to the AnnData file.</p></dd>


<dt>CellrankObj</dt>
<dd><p>the <code>cellrank_obj</code> entry of the output list of <code><a href="fitTransitionModel.html">fitTransitionModel</a>()</code>.</p></dd>


<dt>group.cells.by</dt>
<dd><p>character, column in the metadata to group cells</p></dd>


<dt>source_state</dt>
<dd><p>character, a value in the <code>group.cells.by</code> column which is taken as the source state for fitting transition path theory. All cells belonging to this group are considered as the source.</p></dd>


<dt>target_state</dt>
<dd><p>character, a value in the <code>group.cells.by</code> column which is taken as the target state for fitting transition path theory. All cells belonging to this group are considered as the target.</p></dd>


<dt>conda_env</dt>
<dd><p>character, if not <code>NULL</code> this named conda environment is used to perform TPT analysis.
(Default: <code>NULL</code>, i.e. no conda environment will be used, the program assumes the python packages <code>scanpy</code>, <code>scvelo</code> and <code>cellrank</code> are installed in the local python)</p></dd>


<dt>random_n</dt>
<dd><p>number of times to reshuffle transition matrix columns to derive randomised models (default: 100).</p></dd>


<dt>do_pca</dt>
<dd><p>Should principal component analysis (PCA) be re-computed on the data? (Default: TRUE)</p></dd>


<dt>do_neighbors</dt>
<dd><p>Should k-nearest neighbour (kNN) graph be re-computed on the data? (Default: TRUE)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a list with these entries:</p><dl><dt>gross_flux</dt>
<dd><p>a n-by-n matrix (where n is the total number of states), of total fluxes estimated between from a state (row) to another state (column).</p></dd>

  <dt>pathways</dt>
<dd><p>a data.frame indicating the possible paths to take from <code>source_state</code> to <code>target_state</code>, and the likelihood (max: 100) to travel through each stated path.</p></dd>

  <dt>significance</dt>
<dd><p>a n-by-n matrix (where n is the total number of states), where the observed gross flux is greater than the flux estimated in the randomised models.</p></dd>

  <dt>total_gross_flux</dt>
<dd><p>element-wise sum of the gross_flux matrix.</p></dd>

  <dt>total_gross_flux_reshuffled</dt>
<dd><p>element-wise sum of the gross_flux matrix, calculated over each randomised (randomly reshuffled transition matrix coluns) models.</p></dd>

  <dt>gross_flux_randomised</dt>
<dd><p>gross_flux matrix but from the randomised (randomly reshuffled transition matrix coluns) TPT models.</p></dd>

  <dt>mfpt</dt>
<dd><p>Mean First Passage Time required to travel from <code>source_state</code> to <code>target_state</code> as estimated by Transition Path Theory.</p></dd>

  <dt>mfpt_reshuffled</dt>
<dd><p>Mean First Passage Time required to travel from <code>source_state</code> to <code>target_state</code> as estimated by Transition Path Theory, calculated over each randomised (randomly reshuffled transition matrix coluns) models.</p></dd>

  <dt>stationary_distribution</dt>
<dd><p>Equilibrium probability of each state as estimated by Transition Path Theory.</p></dd>

  <dt>stationary_distribution_reshuffled</dt>
<dd><p>Equilibrium probability of each state as estimated by Transition Path Theory, calculated over each randomised (randomly reshuffled transition matrix coluns) models.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>fitTPT</code> interfaces with (and reimplements some routines to improve efficincy) the Python <code>deeptime</code> package to fit transition path theory (TPT) onto the markov state model defined by running
the <code><a href="fitTransitionModel.html">fitTransitionModel</a></code> function that uses cellrank under the hood. With the parameter <code>group.cells.by</code>, the user specifies
a scheme to group individual row/columns of the transition matrix (for example, by cell type or by isotype). The function
then fits TPT on to this grouped/'coarse-grained' transition matrix, upon user indicating a likely 'source' and 'target' state.
The output are estimated information flows ('flux') between different states in order to flow from the source to the target,
and the probabilities of sampling each state at equilibrium ('stationary distribution').
A random 'null background' model was fitted by randomly reshuffling columns of the transition matrix by <code>random_n</code> (default: 100) times.
These random fluxes help determine the significance of an observed flux, by calculating one-sided empirical probabilities of the observed flux larger than the that observed in the randomised models.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Joseph Ng.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

